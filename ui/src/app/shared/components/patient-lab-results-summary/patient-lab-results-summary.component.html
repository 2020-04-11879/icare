<table class="table" *ngIf="filteredLabTestsResults && !patientVisit">
  <ng-container
    *ngIf="filteredLabTestsResults && filteredLabTestsResults?.length > 0"
  >
    <tr>
      <th>#</th>
      <th>Test</th>
      <th>Result</th>
      <th>SI - unit</th>
    </tr>
    <tr
      *ngFor="let test of filteredLabTestsResults; let i = index"
      [attr.data-index]="i"
    >
      <td>{{ i + 1 }}</td>
      <td>{{ test?.name }}</td>
      <td *ngIf="test?.value">{{ test?.value?.value }}</td>
      <td *ngIf="test?.value">{{ test?.concept?.units || "N/A" }}</td>
      <td *ngIf="test?.parameters" colspan="2">
        <div>
          <p>Parameters</p>
          <table class="table">
            <tr *ngFor="let param of test?.parameters">
              <td>{{ param?.name }}</td>
              <td>{{ param?.value?.value }}</td>
              <td *ngIf="test?.value">{{ param?.concept?.units || "N/A" }}</td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </ng-container>
  <ng-container
    *ngIf="filteredLabTestsResults && filteredLabTestsResults?.length == 0"
  >
    <tr>
      <td class="text-left" colspan="4">No data</td>
    </tr>
  </ng-container>
</table>
<div
  *ngIf="{
    codedResultsData: codedResultsData$ | async,
    testSetMembersDetails: testSetMembersDetails$ | async
  } as params"
>
  <div *ngIf="patientVisit">
    <div *ngIf="labOrdersResultsInformation?.length > 0">
      <mat-progress-bar
        *ngIf="!params?.testSetMembersDetails || !params?.codedResultsData"
        mode="indeterminate"
      ></mat-progress-bar>
      <app-order-results-renderer
        *ngIf="params?.testSetMembersDetails && params?.codedResultsData"
        [testSetMembersDetails]="params?.testSetMembersDetails"
        [codedResultsData]="params?.codedResultsData"
        [observationsKeyedByConcept]="observations"
        [labOrdersResultsInformation]="labOrdersResultsInformation"
      ></app-order-results-renderer>
    </div>
    <div *ngIf="labOrdersResultsInformation?.length === 0">
      <p class="text-center text-warning">No Laboratory test requested</p>
    </div>
  </div>
</div>
